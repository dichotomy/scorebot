/*
* Kendo UI Web v2012.1.322 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(a,b){function u(a,b,c){var d=0,e=b.length-1,f;for(;d<e;++d)f=b[d],f in a||(a[f]={}),a=a[f];a[b[e]]=c}var c=window.kendo,d=c.ui,e=d.Select,f=c.support.mobileOS,g=c.support.touch?"touchend":"click",h="disabled",i="change",j="select",k="k-state-focused",l="k-state-default",m="k-state-disabled",n="k-state-selected",o="k-state-hover",p="mouseenter mouseleave",q=".k-dropdown-wrap",r=/^\s/,s=a.proxy,t=e.extend({init:function(b,d){var f=this,d=a.isArray(d)?{dataSource:d}:d;e.fn.init.call(f,b,d),d=f.options,b=f.element.focus(function(){f.wrapper.focus()}),f._reset(),f._word="",f._wrapper(),f._span(),f._popup(),f._mobile(),f._accessors(),f._dataSource(),f._enable(),f.selectedIndex=-1,d.autoBind?f._selectItem():(b.is(j)&&f.text(b.children(":selected").text()),!f.text().replace(r,"")&&d.optionLabel&&f.text(d.optionLabel)),c.notify(f)},options:{name:"DropDownList",enable:!0,index:0,autoBind:!0,template:"",delay:500,dataTextField:"",dataValueField:"",optionLabel:"",height:200,animation:{}},events:["open","close",i,"select","dataBinding","dataBound"],setOptions:function(a){e.fn.setOptions.call(this,a),this._template(),this._accessors()},setDataSource:function(a){this.options.dataSource=a,this._dataSource(),this._selectItem()},enable:function(a){var b=this,c=b.element,d=b.wrapper.unbind(),e=b._inputWrapper.unbind(p);a===!1?(c.attr(h,h),e.removeClass(l).addClass(m)):(c.removeAttr(h,h),e.addClass(l).removeClass(m).bind(p,b._toggleHover),d.bind({click:function(a){a.preventDefault(),b.toggle()},keydown:s(b._keydown,b),keypress:s(b._keypress,b),focusin:function(){e.addClass(k)},focusout:function(a){b._blur(),e.removeClass(k)}}))},open:function(){var a=this;a.ul[0].firstChild?(a.popup.open(),a._scroll(a._current)):(a._open=!0,a._selectItem())},toggle:function(a){this._toggle(a)},refresh:function(){var a=this,b=a._data(),d=b.length,e=a.options.optionLabel;a.trigger("dataBinding"),a.ul[0].innerHTML=c.render(a.template,b),a._height(d),a.element.is(j)&&(e&&d&&(e='<option value="">'+e+"</option>"),a._options(b,e)),a._open&&a.toggle(d),a._hideBusy(),a._makeUnselectable(),a.trigger("dataBound")},search:function(a){if(a){var c=this;a=a.toLowerCase(),c._select(function(d){var e=c._text(d);if(e!==b)return(e+"").toLowerCase().indexOf(a)===0})}},select:function(a){var c=this;if(a===b)return c.selectedIndex;c._select(a),c._old=c._accessor(),c._oldIndex=c.selectedIndex},text:function(a){var c=this.span;if(a!==b)c.text(a);else return c.text()},value:function(a){var c=this,d=c.element,e;if(a===b)return c._accessor();if(!a||!c._valueOnFetch(a))e=c._index(a),c.select(e>-1?e:0)},_selectItem:function(){var a=this;a.dataSource.one(i,function(){var b=a.value();b?a.value(b):a.select(a.options.index)}).fetch()},_accept:function(a){this._focus(a)},_data:function(){var a=this,b=a.options,d=b.optionLabel,e=b.dataTextField,f=b.dataValueField,g=a.dataSource.view(),h=g.length,i=d,j=0;if(d&&h){e&&(i={},e=e.split("."),f=f.split("."),u(i,f,""),u(i,e,d)),i=new c.data.ObservableArray([i]);for(;j<h;j++)i.push(g[j]);g=i}return g},_keydown:function(a){var b=this,d=a.keyCode,e=c.keys,f=b.ul[0];b._move(a),d===e.HOME?(a.preventDefault(),b._select(f.firstChild)):d===e.END&&(a.preventDefault(),b._select(f.lastChild))},_keypress:function(a){var b=this;setTimeout(function(){b._word+=String.fromCharCode(a.keyCode||a.charCode),b._search()})},_popup:function(){e.fn._popup.call(this),this.popup.one("open",function(){this.wrapper=c.wrap(this.element).addClass("km-popup")})},_search:function(){var a=this;clearTimeout(a._typing),a._typing=setTimeout(function(){a._word=""},a.options.delay),a.search(a._word)},_select:function(a){var c=this,e=c.element[0],f=c._current,g=c._data(),h,i,j;a=c._get(a),a&&a[0]&&!a.hasClass(n)&&(f&&f.removeClass(n),j=d.List.inArray(a[0],c.ul[0]),j>-1&&(g=g[j],i=c._text(g),h=c._value(g),c.selectedIndex=j,c.text(i),c._accessor(h!=b?h:i,j),c.current(a.addClass(n))))},_mobile:function(){var a=this,b=a.popup,c=b.element.parents(".km-root").eq(0);c.length&&f&&(b.options.animation.open.effects=f.android||f.meego?"fadeIn":f.ios?"slideIn:up":b.options.animation.open.effects)},_span:function(){var b=this,c=b.wrapper,d=".k-input",e;e=c.find(d),e[0]||(c.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input">&nbsp;</span><span class="k-select"><span class="k-icon k-arrow-down">select</span></span></span>').append(b.element),e=c.find(d)),b.span=e,b._inputWrapper=a(c[0].firstChild),b._arrow=c.find(".k-icon").mousedown(function(a){a.preventDefault()})},_wrapper:function(){var a=this,b=a.element,c=b[0],d="tabIndex",e;e=b.parent(),e.is("span.k-widget")||(e=b.wrap("<span />").parent()),e.attr(d)||e.attr(d,0),e[0].style.cssText=c.style.cssText,b.hide(),a._focused=a.wrapper=e.attr("unselectable","on").addClass("k-widget k-dropdown k-header").addClass(c.className)}});d.plugin(t)})(jQuery)