/*
* Kendo UI Web v2012.1.322 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at http://kendoui.com/web-license
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(a,b){var c=window.kendo,d=c.ui,e=c.support.touch,f=d.Widget,g=c.parseDate,h=c.keys,i=c.template,j="<div />",k="<span />",l=e?"touchend":"click",m=l+".datepicker",n="open",o="close",p="change",q="navigate",r="dateView",s="disabled",t="k-state-default",u="k-state-focused",v="k-state-selected",w="k-state-disabled",x="k-state-hover",y="mouseenter mouseleave",z=e?"touchstart":"mousedown",A="min",B="max",C="month",D="first",E=c.calendar,F=E.viewsEnum,G=E.isInRange,H=E.restrictValue,I=a.extend,J=a.proxy,K=Date,L=function(b){var c=this,e=document.body,f=M.sharedCalendar;f||(f=M.sharedCalendar=new d.Calendar(a(j).hide().appendTo(e)),E.makeUnselectable(f.element)),c.calendar=f,c.options=b=b||{},c.popup=new d.Popup(a(j).addClass("k-calendar-container").appendTo(e),I(b.popup,b)),c._templates(),c.value(b.value)};L.prototype={_calendar:function(){var a=this,b=a.popup,c=a.options,d=a.calendar,f=d.element;f.data(r)!==a&&(f.appendTo(b.element).data(r,a).undelegate(m).delegate("td:has(.k-link)",m,J(a._click,a)).unbind(z).bind(z,function(a){a.preventDefault()}).show(),d.unbind(p).bind(p,c),e||d.unbind(q).bind(q,J(a._navigate,a)),d.month=a.month,d.options.depth=c.depth,d._footer(a.footer),d.min(c.min),d.max(c.max),d.navigate(a._value,c.start),a.value(a._value))},open:function(){var a=this;a._calendar(),a.popup.open()},close:function(){this.popup.close()},min:function(a){this._option(A,a)},max:function(a){this._option(B,a)},toggle:function(){var a=this;a[a.popup.visible()?o:n]()},move:function(a){var b=this,c=b.options,d=c.min,e=c.max,f=new K(b._current),g=b.calendar,i=g._index,j=g._view,k=a.keyCode,l,m,n,o;if(k==h.ESC)b.close();else{if(a.altKey){k==h.DOWN?(b.open(),n=!0):k==h.UP&&(b.close(),n=!0);return}if(!b.popup.visible()||g._table.parent().data("animating"))return;if(a.ctrlKey)k==h.RIGHT?(g.navigateToFuture(),n=!0):k==h.LEFT?(g.navigateToPast(),n=!0):k==h.UP?(g.navigateUp(),n=!0):k==h.DOWN&&(b._navigateDown(),n=!0);else{k==h.RIGHT?(m=1,n=!0):k==h.LEFT?(m=-1,n=!0):k==h.UP?(m=i===0?-7:-4,n=!0):k==h.DOWN?(m=i===0?7:4,n=!0):k==h.ENTER?(b._navigateDown(),n=!0):k==h.HOME||k==h.END?(o=k==h.HOME?D:"last",f=j[o](f),n=!0):k==h.PAGEUP?(n=!0,g.navigateToPast()):k==h.PAGEDOWN&&(n=!0,g.navigateToFuture());if(m||o)o||j.setDate(f,m),b._current=f=H(f,c.min,c.max),g._focus(f)}n&&a.preventDefault()}},value:function(a){var b=this,c=b.calendar,d=b.options;b._value=a,b._current=new K(H(a,d.min,d.max)),c.element.data(r)===b&&(c._focus(b._current),c.value(a))},_click:function(a){a.currentTarget.className.indexOf(v)!==-1&&this.close()},_navigate:function(){var a=this,b=a.calendar;a._current=new K(b._current),b._focus(b._current)},_navigateDown:function(){var a=this,b=a.calendar,d=b._current,e=b._table.find("."+u),f=e.children(":"+D).attr(c.attr("value")).split("/");f=new K(f[0],f[1],f[2]);!e[0]||e.hasClass(v)?a.close():(b._view.setDate(d,f),b.navigateDown(d))},_option:function(a,b){var c=this,d=c.options,e=c.calendar;d[a]=b,e.element.data(r)===c&&e[a](b)},_templates:function(){var a=this,b=a.options,d=b.footer,e=b.month||{},f=e.content,g=e.empty;a.month={content:i('<td#=data.cssClass#><a class="k-link" href="\\#" '+c.attr("value")+'="#=data.dateString#" title="#=data.title#">'+(f||"#=data.value#")+"</a></td>",{useWithBlock:!!f}),empty:i("<td>"+(g||"&nbsp;")+"</td>",{useWithBlock:!!g})},d&&(a.footer=i(d,{useWithBlock:!1}))}},c.DateView=L;var M=f.extend({init:function(a,b){var d=this,e,g;f.fn.init.call(d,a,b),a=d.element,b=d.options,E.validate(b),d._wrapper(),d.dateView=e=new L(I({},b,{anchor:d.wrapper,change:function(){d._change(this.value()),d.close()},close:function(a){d.trigger(o)&&a.preventDefault()},open:function(a){d.trigger(n)&&a.preventDefault()}})),d._icon(),a.addClass("k-input").bind({keydown:J(d._keydown,d),focus:function(a){d._inputWrapper.addClass(u)},blur:J(d._blur,d)}).closest("form").bind("reset",function(){d.value(a[0].defaultValue)}),d.enable(!a.is("[disabled]")),d.value(b.value||d.element.val()),c.notify(d)},events:[n,o,p],options:{name:"DatePicker",value:null,format:"",min:new Date(1900,0,1),max:new Date(2099,11,31),footer:'#= kendo.toString(data,"D") #',start:C,depth:C,animation:{},month:{}},setOptions:function(a){f.fn.setOptions.call(this,a),I(this.dateView.options,a)},enable:function(a){var b=this,c=b._icon.unbind(l+" "+z),d=b._inputWrapper.unbind(y),e=b.element;a===!1?(d.removeClass(t).addClass(w),e.attr(s,s)):(d.addClass(t).removeClass(w).bind(y,b._toggleHover),e.removeAttr(s),c.bind(l,J(b._click,b)).bind(z,function(a){a.preventDefault()}))},open:function(){this.dateView.open()},close:function(){this.dateView.close()},min:function(a){return this._option(A,a)},max:function(a){return this._option(B,a)},value:function(a){var c=this;if(a===b)return c._value;c._old=c._update(a)},_toggleHover:function(b){e||a(b.currentTarget).toggleClass(x,b.type==="mouseenter")},_blur:function(){var a=this;a.close(),a._change(a.element.val()),a._inputWrapper.removeClass(u)},_click:function(){var a=this,b=a.element;!e&&b[0]!==document.activeElement&&b.focus(),a.dateView.toggle()},_change:function(a){var b=this;a=b._update(a),+b._old!=+a&&(b._old=a,b.trigger(p),b.element.trigger(p))},_keydown:function(a){var b=this,c=b.dateView;!c.popup.visible()&&a.keyCode==h.ENTER?b._change(b.element.val()):c.move(a)},_icon:function(){var b=this,c=b.element,d;d=c.next("span.k-select"),d[0]||(d=a('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-icon-calendar">select</span></span>').insertAfter(c)),b._icon=d},_option:function(a,c){var d=this,e=d.options;if(c===b)return e[a];c=g(c,e.format);!c||(e[a]=new K(c),d.dateView[a](c))},_update:function(a){var b=this,d=b.options,e=d.format,f=g(a,e);G(f,d.min,d.max)||(f=null),b._value=f,b.dateView.value(f),b.element.val(f?c.toString(f,e):a);return f},_wrapper:function(){var b=this,c=b.element,d;d=c.parents(".k-datepicker"),d[0]||(d=c.wrap(k).parent().addClass("k-picker-wrap k-state-default"),d=d.wrap(k).parent()),d[0].style.cssText=c[0].style.cssText,c.css({width:"100%",height:c[0].style.height}),b.wrapper=d.addClass("k-widget k-datepicker k-header"),b._inputWrapper=a(d[0].firstChild)}});d.plugin(M)})(jQuery)